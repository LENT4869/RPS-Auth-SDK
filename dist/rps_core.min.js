!function(e){"use strict";const r=["apple","banana","cat","dog","elephant","fish","grape","hat","ice","jungle","kite","lion","monkey","nest","orange","pig","queen","rabbit","sun","tiger","umbrella","van","whale","xray","yellow","zebra"],n={wordList:r,wordCount:12,prefixLength:3,noiseLength:3,salt:"quori-default"};function t(e=3){if(!Number.isInteger(e)||e<=0)throw new Error("RpsCore.generateRandomNoise: length must be a positive integer.");const r="abcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let t=0;t<e;t++)n+=r[Math.floor(36*Math.random())];return n}const o={defaultWordList:r,defaultConfig:n,generateRandomNoise:t,generateRandomMnemonic:function(e={}){const{wordList:r=n.wordList,wordCount:o=n.wordCount,prefixLength:i=n.prefixLength,noiseLength:s=n.noiseLength}=e;if(!Array.isArray(r)||0===r.length)throw new Error("RpsCore.generateRandomMnemonic: wordList must contain at least 1 entry.");if(!Number.isInteger(o)||o<=0)throw new Error("RpsCore.generateRandomMnemonic: wordCount must be a positive integer.");if(!Number.isInteger(i)||i<=0)throw new Error("RpsCore.generateRandomMnemonic: prefixLength must be a positive integer.");if(!Number.isInteger(s)||s<0)throw new Error("RpsCore.generateRandomMnemonic: noiseLength must be a non-negative integer.");const a=[];for(let e=0;e<o;e++){const e=(r[Math.floor(Math.random()*r.length)]||"").slice(0,i),n=t(s);a.push(e+n)}return a.join(" ")},getRandomIndices:function(e,r){if(!Number.isInteger(e)||!Number.isInteger(r)||e<=0||r<=0)throw new Error("RpsCore.getRandomIndices: count and max must be positive integers.");if(e>r)throw new Error("RpsCore.getRandomIndices: count cannot be greater than max.");const n=new Set;for(;n.size<e;)n.add(Math.floor(Math.random()*r));return[...n].sort((e,r)=>e-r)},sha256WithSalt:async function(e,r=n.salt){if("string"!=typeof e)throw new Error("RpsCore.sha256WithSalt: text must be a string.");const t=(new TextEncoder).encode(e+r),o=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(o)).map(e=>e.toString(16).padStart(2,"0")).join("")},verifyRps:function({mnemonic:e,indices:r,inputs:t,prefixLength:o=n.prefixLength}){if(!e||"string"!=typeof e)throw new Error("verifyRps: mnemonic must be an array or space-separated string.");if(!Array.isArray(r)||!Array.isArray(t))return!1;if(!Number.isInteger(o)||o<=0)return!1;const i=e.split(" ").filter(Boolean);if(0===i.length)return!1;for(const e of i)if(o>e.length)throw new Error("verifyRps: prefixLength is larger than word length.");if(r.length!==t.length)throw new Error("verifyRps: indices length does not match inputs length.");return r.every((e,r)=>{const n=(i[e]||"").slice(0,o).toLowerCase();return(t[r]||"").trim().toLowerCase().slice(0,o)===n})}};"undefined"!=typeof module&&module.exports&&(module.exports=o),e&&(e.RpsCore=o)}("undefined"!=typeof window?window:globalThis);