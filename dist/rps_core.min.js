!function(e){"use strict";const t=["apple","banana","cat","dog","elephant","fish","grape","hat","ice","jungle","kite","lion","monkey","nest","orange","pig","queen","rabbit","sun","tiger","umbrella","van","whale","xray","yellow","zebra"],n={wordList:t,wordCount:12,prefixLength:3,noiseLength:3,salt:"quori-default"};function r(e=3){if(!Number.isInteger(e)||e<=0)throw new Error("RpsCore.generateRandomNoise: length must be a positive integer.");const t="abcdefghijklmnopqrstuvwxyz0123456789";let n="";for(let r=0;r<e;r++)n+=t[Math.floor(36*Math.random())];return n}const o={defaultWordList:t,defaultConfig:n,generateRandomNoise:r,generateRandomMnemonic:function(e={}){const{wordList:t=n.wordList,wordCount:o=n.wordCount,prefixLength:i=n.prefixLength,noiseLength:s=n.noiseLength}=e;if(!Array.isArray(t)||0===t.length)throw new Error("RpsCore.generateRandomMnemonic: wordList must contain at least 1 entry.");if(!Number.isInteger(o)||o<=0)throw new Error("RpsCore.generateRandomMnemonic: wordCount must be a positive integer.");if(!Number.isInteger(i)||i<=0)throw new Error("RpsCore.generateRandomMnemonic: prefixLength must be a positive integer.");if(!Number.isInteger(s)||s<0)throw new Error("RpsCore.generateRandomMnemonic: noiseLength must be a non-negative integer.");const a=[];for(let e=0;e<o;e++){const e=(t[Math.floor(Math.random()*t.length)]||"").slice(0,i),n=r(s);a.push(e+n)}return a.join(" ")},getRandomIndices:function(e,t){if(!Number.isInteger(e)||!Number.isInteger(t)||e<=0||t<=0)throw new Error("RpsCore.getRandomIndices: count and max must be positive integers.");if(e>t)throw new Error("RpsCore.getRandomIndices: count cannot be greater than max.");const n=new Set;for(;n.size<e;)n.add(Math.floor(Math.random()*t));return[...n].sort((e,t)=>e-t)},sha256WithSalt:async function(e,t=n.salt){if("string"!=typeof e)throw new Error("RpsCore.sha256WithSalt: text must be a string.");const r=(new TextEncoder).encode(e+t),o=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(o)).map(e=>e.toString(16).padStart(2,"0")).join("")},verifyRps:function({mnemonic:e,indices:t,inputs:r,prefixLength:o=n.prefixLength}){if(!e||"string"!=typeof e)return!1;if(!Array.isArray(t)||!Array.isArray(r))return!1;if(!Number.isInteger(o)||o<=0)return!1;const i=e.split(" ").filter(Boolean);return 0!==i.length&&(t.length===r.length&&t.every((e,t)=>{const n=(i[e]||"").slice(0,o).toLowerCase();return(r[t]||"").trim().toLowerCase().slice(0,o)===n}))}};"undefined"!=typeof module&&module.exports&&(module.exports=o),e&&(e.RpsCore=o)}("undefined"!=typeof window?window:globalThis);